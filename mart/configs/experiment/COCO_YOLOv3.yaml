# @package _global_

defaults:
  - override /datamodule: coco_yolo
  - override /model: yolo
  - override /optimization: super_convergence
  - override /metric: average_precision

task_name: "COCO_YOLOv3"
tags: ["evaluation"]

optimized_metric: "test_metrics/map"

trainer:
  # 117,266 training images, 6 epochs, batch_size=16, 43,974.75
  max_steps: 43975
  # FIXME: "nms_kernel" not implemented for 'BFloat16', torch.ops.torchvision.nms().
  precision: 32

datamodule:
  num_workers: 4
  ims_per_batch: 8

model:
  modules:
    yolo:
      config_path: ${paths.data_dir}/yolov3.cfg
      weights_path: ${paths.data_dir}/yolov3.weights

  optimizer:
    lr: 0.001
    momentum: 0.9
    weight_decay: 0.0005

  training_metrics: null
