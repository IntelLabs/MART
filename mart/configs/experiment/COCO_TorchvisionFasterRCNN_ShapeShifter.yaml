# @package _global_

defaults:
  - COCO_TorchvisionFasterRCNN
  - /attack@model.modules.input_adv: object_detection_universal_missed

task_name: "COCO_TorchvisionFasterRCNN_ShapeShifter"
tags: ["adv"]

datamodule:
  ims_per_batch: 1

model:
  modules:
    losses_and_detections:
      model:
        model:
          weights: "FasterRCNN_ResNet50_FPN_Weights.COCO_V1"
      freeze: True # FIXME: We need a more generic freeze mechanism since we often don't own model code.

  optimizer:
    lr: 0 # Turn off learning!

  training_sequence:
    seq005: input_adv

    seq010:
      preprocessor: ["input_adv"]

  validation_sequence: ${.training_sequence}

  test_sequence: ${.validation_sequence}
