# @package _global_

defaults:
  - COCO_TorchvisionFasterRCNN
  - override /model/modules@model.modules.preprocessor: tuple_tensorizer_normalizer
  - override /datamodule: armory_carla_over_objdet_perturbable_mask

task_name: "ArmoryCarlaOverObjDet_TorchvisionFasterRCNN"
tags: ["regular_training"]

optimized_metric: "test_metrics/map"

model:
  load_state_dict: null

  modules:
    roi_heads:
      box_predictor:
        num_classes: 3

  optimizer:
    lr: 0.0125
    momentum: 0.9
    weight_decay: 1e-4

trainer:
  # 3,600 training images, batch_size=2, 6 epochs
  # max_steps = 3600 / 2 * 6
  max_steps: 10800
